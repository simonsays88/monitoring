<?php

namespace AppBundle\Repository;

/**
 * PackRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class PackRepository extends \Doctrine\ORM\EntityRepository
{

    public function getAllPacksFoodAndFoodBody($completed, $packTypeId)
    {
        $q = $this->createQueryBuilder('p')
            ->where('p.pack_type != :type');
        if ($completed !== null && $completed != 'all') {
            $q->join('p.initial', 'i')
                ->andWhere('i.completed = :completed')
                ->setParameter('completed', $completed);
        }
        if ($packTypeId !== null && $packTypeId != 'all') {
            $q->andWhere('p.pack_type_id = :pack_type_id')
                ->setParameter('pack_type_id', $packTypeId);
        }
        $q->orderBy('p.startedAt', 'DESC')
            ->setParameter('type', 'themes')
            ->getQuery()
            ->getResult();

        return $q->getQuery()->getResult();
    }

    public function getAllPacksThemes($completed)
    {
        $q = $this->createQueryBuilder('p')
            ->where('p.pack_type = :type');
        if ($completed !== null && $completed != 'all') {
            $q->join('p.initial', 'i')
                ->andWhere('i.completed = :completed')
                ->setParameter('completed', $completed);
        }
        if ($packTypeId !== null && $packTypeId != 'all') {
            $q->andWhere('p.pack_type_id = :pack_type_id')
                ->setParameter('pack_type_id', $packTypeId);
        }
        $q->orderBy('p.startedAt', 'DESC')
            ->setParameter('type', 'themes')
            ->getQuery()
            ->getResult();

        return $q->getQuery()->getResult();
    }
}